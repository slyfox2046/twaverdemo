<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>P30</title>
    <script src="../common/twaver/twaver.js"></script>
    <script src="../common/twaver/license.js"></script>
    <script type="text/javascript">
        var box = new twaver.ElementBox();
        var network = new twaver.vector.Network(box);
        var bus = new twaver.Bus();
        // var busCount = 40;
        var busCount = 4;

        function init() {
            initNetwork();
            initListener();
            initDataBox();
        }

        function initNetwork() {
            document.body.appendChild(network.getView());
            network.adjustBounds({x: 0, y: 0, width: 1300, height: 600});
            twaver.Styles.setStyle('group.expanded', true);
        }

        function initListener() {

        }

        function initDataBox() {
            bus.setStyle('vector.outline.width', 3);
            bus.setStyle('vector.outline.color', twaver.Colors.green_light);
            bus.setStyle('bus.style', 'south');
            bus.setLocation(500, 500);
            box.add(bus);
            for (var i = 0; i < busCount; i++) {
                var id = "10.0.0." + i;
                var node = new twaver.Node(id);
                node.setName(id);
                box.add(node);
                var link = new twaver.Link(node, bus);
                link.setStyle('link.width', 2);
                link.setStyle('link.color', twaver.Colors.orange_light);
                box.add(link);
            }
            refreshBus();

        }

        function refreshBus() {
            bus.getPoints().clear();
            // bus.getPoints().add({
            //     x:50,
            //     y:200-15
            // });
            // bus.getPoints().add({
            //     x:50,
            //     y:200+15
            // });

            // bus.getPoints().add({
            //     x: 50,
            //     y: 200
            // });
            // bus.getPoints().add({
            //     x: 150,
            //     y: 250
            // });
            // bus.getPoints().add({
            //     x: 200,
            //     y: 300
            // });
            // bus.getPoints().add({
            //     x: 500,
            //     y: 350
            // });

            bus.getPoints().add({x: 80, y: 135}         );
            bus.getPoints().add({x: 80, y: 105}         );
            bus.getPoints().add({x: 80, y: 120}         );
            bus.getPoints().add({x: 1200, y: 120}       );
            bus.getPoints().add({x: 1200, y: 240}       );
            bus.getPoints().add({x: 80, y: 240}         );
            bus.getPoints().add({x: 80, y: 360}         );
            // bus.getPoints().add({x: 1200, y: 360}       );
            // bus.getPoints().add({x: 1200, y: 480}       );

            var node = box.getDataById("10.0.0.0" );
            node.setCenterLocation(100,50);
            var node = box.getDataById("10.0.0.1" );
            node.setCenterLocation(200,50);
            var node = box.getDataById("10.0.0.2" );
            node.setCenterLocation(350,400);
            var node = box.getDataById("10.0.0.3" );
            node.setCenterLocation(300,50);

            // var node = box.getDataById("10.0.0.0" );
            // node.setCenterLocation(80,135);
            // var node = box.getDataById("10.0.0.1" );
            // node.setCenterLocation(80,105);
            // var node = box.getDataById("10.0.0.2" );
            // node.setCenterLocation(80,120);
            // var node = box.getDataById("10.0.0.3" );
            // node.setCenterLocation(1200,120);




            console.log(bus.getPoints().size());
            //最后一个点 向上，向下各15，画个竖线
            var point = bus.getPoints().get(bus.getPoints().size() - 1);
            bus.getPoints().add({
                x: point.x,
                y: point.y + 15
            });
            bus.getPoints().add({
                x: point.x,
                y: point.y - 15
            });


            // bus.firePointsChange();
        }

    </script>

</head>
<body onload="init()">

</body>

</html>
